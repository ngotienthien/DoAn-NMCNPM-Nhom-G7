
<div class="container">
  <div class="row">
    <div class="col-sm-3">
      <!--left col-->
      <div class="text-center">
        <h1>User name</h1>
        <img src="http://ssl.gstatic.com/accounts/ui/avatar_2x.png" class="avatar img-circle img-thumbnail"
          alt="avatar">
        <h6>Upload a different photo...</h6>
        <input type="file" class="text-center center-block file-upload">
      </div>
      <ul class="list-group mt-5 ">
        <li class="list-group-item text-right"><span class="pull-left"><strong>Shares</strong></span> 125</li>
        <li class="list-group-item text-right"><span class="pull-left"><strong>Likes</strong></span> 13</li>
        <li class="list-group-item text-right"><span class="pull-left"><strong>Comment</strong></span> 37</li>
      </ul>
    </div>
    <!--/col-3-->
    <div class="col-sm-9">
      <nav class="mt-3">
        <div class="nav nav-tabs" id="nav-tab" role="tablist">
          <a class="nav-item nav-link" id="nav-home-tab" data-toggle="tab" href="#nav-home" role="tab"
            aria-controls="nav-home" aria-selected="true">Profile</a>
          <a class="nav-item nav-link " id="nav-profile-tab" data-toggle="tab" href="#nav-profile" role="tab"
            aria-controls="nav-profile" aria-selected="false">Update Profile</a>
          <a class="nav-item nav-link" id="nav-password-tab" data-toggle="tab" href="#nav-password" role="tab"
            aria-controls="nav-profile" aria-selected="false">Update Password</a>
        </div>
      </nav>

      <div class="tab-content" id="nav-tabContent">
        <div class="tab-pane fade show active" id="nav-home" role="tabpanel" aria-labelledby="nav-home-tab">
          <div class="p-5">
            <div action="updateProfile" method="post">              
              <div class="form-group">
                <label>Username</label>
                <input type="text" class="form-control" value="{{infoUser.UserName}}" id="username"  placeholder="username" readonly>
              </div>
              <div class="form-group">
                <label>Email</label>
                <input type="text" class="form-control" value="{{infoUser.Email}}" id="email" placeholder="email" readonly>
              </div>
              <div class="form-group">
                <label>Full name</label>
                <input type="text" class="form-control" value="{{infoUser.FullName}}" id="fullname" placeholder="Fullname" readonly>
              </div>
              <div class="form-group">
                <label>Phone</label>
                <input type="text" class="form-control" value="{{infoUser.Phone}}" id="phone"  placeholder="Phone" readonly>
              </div>
              <div class="form-group">
                <label>Address</label>
                <input type="text" class="form-control" value="{{infoUser.Address}}" id="Address"  placeholder="Address" readonly>
              </div>
              <div class="form-group">
                <label>Date Of Birth</label>
                <input type="text" class="form-control" value="{{infoUser.DOB}}" id="DOB" readonly>
              </div>
              
            </div>
          </div>
        </div>
        <div class="tab-pane fade" id="nav-profile" role="tabpanel" aria-labelledby="nav-profile-tab">
          <div class="p-5">
            <form action="/updateProfile" method="post" name="form_updateProfile" onsubmit="return validateFormProfile()">
              <div class="form-group">
                  {{{notificationProfileUpdated}}}
              </div>
              <div class="form-group">
                <label>Full Name</label>
                <input type="text" class="form-control" value="{{infoUser.FullName}}" id="idFullName" name="FullName" placeholder="Fullname">
              </div>
              <div class="form-group">
                <label>Email</label>
                <input type="text" class="form-control" value="{{infoUser.Email}}" id="idEmail" name="Email" placeholder="Email">
              </div>
              {{#if infoUser.NickName}}
                <div class="form-group">
                <label>Nick Name</label>
                <input type="text" class="form-control" value="{{infoUser.NickName}}" id="idNickName" name="NickName" placeholder="NickName" {{#unless infoUser.isWriter}} readonly {{/unless}}>
                </div>
              {{/if}}
              <div class="form-group">
                <label>Date Of Birth</label>
                <input type="text" class="form-control CDOB" value="{{infoUser.DOB}}" id="idDOB" name="DOB">
              </div>      
              <div class="form-group">
                  <label>Phone</label>
                  <input type="text" name="Phone" value="{{infoUser.Phone}}" onkeypress='return event.charCode >= 48 && event.charCode <= 57' minlength="9" maxlength="11" class="form-control" id="idPhone" placeholder="Phone">
              </div>

              <div class="form-group">
                  <label>Address</label>
                  <input type="text" name="Address" value="{{infoUser.Address}}" class="form-control" id="idAddress" placeholder="Address">
              </div>
                              
              <div class="form-group">
                <label>Password</label>
                <input type="password" class="form-control" id="Password" name="Password" placeholder="Password">
                <span class = 'text-danger'>{{notificationPassword}}</span>
              </div>    
              <button type="submit" class="btn vizew-btn w-100 mt-30">Update</button>
            </form>
          </div>
        </div>
        <div class="tab-pane fade" id="nav-password"  role="tabpanel" onsubmit="return validateFormPassword()" aria-labelledby="nav-profile-tab">
          <div class="p-5">
            <form action="/updatePassword" name="form_updatePassword" method="post">  
              <div class="form-group">
                  {{{notificationPasswordUpdated}}}
              </div>            
              <div class="form-group">
                <label>Old Password</label>
                <input type="password" class="form-control" id="OldPassword" minlength="8" name="OldPassword" placeholder="Old Password">
                <span class = 'text-danger'>{{notificationOldPassword}}</span>
              </div>
              <div class="form-group">
                <label>New Password</label>
                <input type="password" class="form-control" id="NewPassword" minlength="8" name="NewPassword" placeholder="New Password">
              </div>
              <div class="form-group">
                <label>Confirm Password</label>
                <input type="password" class="form-control" id="ConfirmPassword" minlength="8" name="ConfirmPassword" placeholder="Password repeat">
                <span class = 'text-danger'>{{notificationConfirmPassword}}</span>
              </div>
                            
              <button type="submit" class="btn vizew-btn w-100 mt-30">Update</button>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!--/col-9-->
</div>

{{#section 'css'}}
    <link rel="stylesheet" type="text/css" href="/assets/datetimepicker-master/jquery.datetimepicker.css"/ >
{{/section}}



{{#section 'js'}}
<script src="/assets/datetimepicker-master/build/jquery.datetimepicker.full.min.js"></script>
<script>
  $('.CDOB').datetimepicker({     
      format: 'd/m/Y',
      timepicker: false,
      mask:true,
  });
</script>
  
<script>
  const queryString = window.location.search;
  const urlParams = new URLSearchParams(queryString);
  const id = urlParams.get('id');
  
  if(id === "nav-profile")
    document.getElementById("nav-profile-tab").click();
  else if(id === "nav-password")
    document.getElementById("nav-password-tab").click();
  else
    document.getElementById("nav-home-tab").click();

</script>
<script>
  function validateFormProfile(){
    var countError = 0;

    var Password = document.forms["form_updateProfile"]["Password"];
    var FullName = document.forms["form_updateProfile"]["FullName"];
    var Email = document.forms["form_updateProfile"]["Email"];
    var DOB = document.forms["form_updateProfile"]["DOB"];
    var Phone = document.forms["form_updateProfile"]["Phone"];
    var Address = document.forms["form_updateProfile"]["Address"];

    var listClassError = document.getElementsByClassName("error");

    for(i = 0; i < listClassError.length; i++){
        listClassError[i].remove();
        i--;
    }

    if (Password.value.length < 1) {
        var spanPassword = document.createElement("span");
        spanPassword.innerHTML = "This field is required";
        spanPassword.className = "error text-danger";
        Password.after(spanPassword);
        countError++;
    }

    if (FullName.value.length < 1) {
        var spanFullName = document.createElement("span");
        spanFullName.innerHTML = "This field is required";
        spanFullName.className = "error text-danger";
        FullName.after(spanFullName);
        countError++;
    }
    
    if (Phone.value.length < 1 || Phone.value.length > 11) {
      var spanPhone = document.createElement("span");
      spanPhone.innerHTML = "Phone invalid";
      spanPhone.className = "error text-danger";
      Phone.after(spanPhone);
      countError++;
    }

    if (Address.value.length < 1) {
      var spanAddress = document.createElement("span");
      spanAddress.innerHTML = "This field is required";
      spanAddress.className = "error text-danger";
      Address.after(spanAddress);
      countError++;
    }

    if (Email.value.length < 1) {
        var spanEmail= document.createElement("span");
        spanEmail.innerHTML = "This field is required";
        spanEmail.className = "error text-danger";
        Email.after(spanEmail);
        countError++;
    } else {
        var regEx = /^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/i;
        var validEmail = regEx.test(Email.value);
        if (!validEmail) {
            var spanEmail = document.createElement("span");
            spanEmail.innerHTML = "Email is invalid";
            spanEmail.className = "error text-danger";
            Email.after(spanEmail);
            countError++;
        }
    }

    if (DOB.value.length < 1 || DOB.value == "__/__/____") {
        var spanDOB = document.createElement("span");
        spanDOB.innerHTML = "This field is required";
        spanDOB.className = "error text-danger";
        DOB.after(spanDOB);
        countError++;
    }

    if (countError >= 1)       
        return false ;
    

    return true;
  }

  function validateFormPassword(){
    var countError = 0;

    var OldPassword = document.forms["form_updatePassword"]["OldPassword"];
    var NewPassword = document.forms["form_updatePassword"]["NewPassword"];
    var ConfirmPassword = document.forms["form_updatePassword"]["ConfirmPassword"];

    var listClassError = document.getElementsByClassName("error");

    for(i = 0; i < listClassError.length; i++){
        listClassError[i].remove();
        i--;
    }

    if (OldPassword.value.length < 1) {
        var spanOldPassword = document.createElement("span");
        spanOldPassword.innerHTML = "This field is required";
        spanOldPassword.className = "error text-danger";
        OldPassword.after(spanOldPassword);
        countError++;
    }

    if (NewPassword.value.length < 1) {
        var spanNewPassword = document.createElement("span");
        spanNewPassword.innerHTML = "This field is required";
        spanNewPassword.className = "error text-danger";
        NewPassword.after(spanNewPassword);
        countError++;
    }

    if (ConfirmPassword.value.length < 1) {
        var spanConfirmPassword = document.createElement("span");
        spanConfirmPassword.innerHTML = "This field is required";
        spanConfirmPassword.className = "error text-danger";
        ConfirmPassword.after(spanConfirmPassword);
        countError++;
    }

    if (NewPassword.value != ConfirmPassword.value) {
        var spanConfirmPassword2 = document.createElement("span");
        spanConfirmPassword2.innerHTML = "Confirm password was wrong, ";
        spanConfirmPassword2.className = "error text-danger";
        ConfirmPassword.after(spanConfirmPassword2);
        countError++;
    }

    if (countError >= 1)       
        return false ;
    

    return true;
  }
</script>
{{/section}}
